---
os: linux
dist: bionic

language: node_js
node_js:
  - lts/*

install:
  - wget "https://github.com/gohugoio/hugo/releases/download/v${HUGO_RELEASE}/hugo_extended_${HUGO_RELEASE}_Linux-64bit.deb"
  - sudo dpkg -i hugo*.deb
  - npm install

script:
  - hugo version
  - hugo --minify

before_deploy:
  - openssl aes-256-cbc -K $encrypted_db2095f63ba3_key -iv $encrypted_db2095f63ba3_iv -in deploy_rsa.enc -out /tmp/deploy_rsa -d
  - eval "$(ssh-agent -s)"
  - chmod 600 /tmp/deploy_rsa
  - ssh-add /tmp/deploy_rsa
  - echo -e "Host ${DEPLOY_HOST}\n\tStrictHostKeyChecking no\n" >> ~/.ssh/config

deploy:
  provider: script
  skip_cleanup: true
  script: rsync -r --quiet --delete ${TRAVIS_BUILD_DIR}/public/ ${DEPLOY_USER}@${DEPLOY_HOST}:${DEPLOY_DIRECTORY}
  on:
    branch: master

env:
  global:
    - PRODUCTION=true
    - HUGO_RELEASE=0.74.3
    - secure: NdGDbxoPRk1P+H9/5eSIIaLeS6ztvlhxdK+dGAxPJdwnE0F73UV/E8S9yYzUZZTH78zrB1auikx4oqSHKdhVfgd2jLAX/afTL33pPvPPnWJISw+DEeuF7Q4wVWYWe8ztwnNI6gzsgni8xMj1gDtpS/cqu0KOLKDCGv+oE99D4jjFIgN9YyV3TepC8KNzfb1RJdjemQDkGb4cS71gKqS3nttGe3GQsE43g3xXM3IEYfe2zsfBUvxuVibwq24z586zPTOFzdPG2wa07U3ZuQxXVCwv6ZDVJw7lj8f114eSS4dVn/uxSaZ0DO3gIKD8kTpXPzVus7sGLuUACVi5gIwXJXNfS1733uO71ObA65mpHX3U+Gfu7iEP612gtk8VDfrCtf/6PeVzir92K+R8Jzo9+Hm7UEhBhbQdnw9Xb3ciTSk5McbzzJmEKbNLHEYvOI+BPYb14VkXskb//IjM0/afYI3A97n6vBI9KA1WjQJPt6YjYetB0+2LD0iO4zyOkDnu+zB+byRywfy3M/fiaB8UF+5PA8CmQqqnwddASGNFkMiwXeGldKa6ENfN1itydQFLEeUeS+7ETW/BBHHALKUL2p0bZBOdRQC3CZ0PGm8+WaHZpbXsMiiMwzDX6Nj9eoZP5wVpBcObn1Lws6e8sF3uIHm4TS0C7HVNkgbgPCXDWE4=
    - secure: iNxRy0hfZERjI2YlpSVHzUc0kpJQqIusuuvRkpEpqXO1dovKMwOwSN4lHklmKFdHmDN7x0urituT+HTBgqZ7jyNrdNgaXmPz8fPzcSx6buwwCP+N0q/7peP31ZfkiVa3Kx5iGFW6cuqoR+bOk1QfQPy4dYhoBqNdgYrcD6TkkHRCwcOHfNGvBMx9aPapEIBS7NXLOL1dDXHDTQ04XGSVmx5rYmIyphukehUfJsu4lxM63gNokk31TTmo97I587igw+2XcgowLxKflT6rV+obD7fvpzorFZGwnJ/kupji1Quw6qLW2HOKylBF/E/1E9pAHThOig3fwnm2l8Idm22RBtCUEbmlqvApMIqY0CoKmihM53yPDmQamGJGYqIaK3KGOlhoNDNbQieBs9HAtpovFFXVZKhbeKLE4G8g2ppWBTWcOAeNt1c1/hymTac+26+QpqIVDAyCPhbiCvbMRYMzgdLriNjHQgRz75/720n3bzPBprBkk5NJVpf9X4fqLCbug4d4MUaxF4YmVIxmCS8wmzq/7rkjUS/+UaszFB556vxqy+hdmt6gzAw/IIfbvnJR45/xDcsEDuOemKkkf2fOtwJbdZe+fawRl5jZgTA52YbZVpfFw2oZhe5PFTTO6+ZC6Qpk04SqSuIFpj4168aUhclf86Tsow4g7hIviGTm9/0=
    - secure: uiAzNNdvwQXYDeLIK68J1XrnsatjJhQ34sjp783PtA4WU79rsBMHrNRwnYqajZnEBy+CiqY3kcup4KslHQtTorj+qAnMMXqjU4Mh3nk5rYsnIIsDVMex4aTdCU4fBPcXuF4so71Nh3/j/auPzv5HuWpzoaD7nIbucizDI6lEJoVDG/1iwlo6PACB8UbXL4qTyVrzAYyiZcdywPOpKagLUlj5Z36KEvm0SNlVh6GsR1aXEKuw94M0KYZ6GCuA2KZZdGubNMprMXtb6zZxnZt0qx9jQVflrzNXRniPze3/3pv9ymbW6wad/UuheEst2E2KzZ+/bhK1P9R8zbBgNsZgjjxkpUUZFucZZMraDHokJ1s/lYgfSs3wJsWou7lCjTgbCQKPnAptT+KAVl1kvr8kM55DbzxMR/66yhr29uP/I0dKHS+dHsq4knAfMhTkeIESVc7j+XlnxdYklv9X0hUkdK7DqE3g5oQMg+lED7hRRQuxiPcY11P8/o2w1LJcpErvJAOxRbCe9ZJVz9yWrRiRjALT0a9+zBqM783ullJJZNDdB7Iqv+BUHkZK5oe0gapdSqLzdSjba5dg0kkmN41Dco4VlzqKqi+leb+ukYfwdltTGB4h3UPWYVzP5zb4tQIOkVEjxyCFsd+eLmYvYC6Z8TyRv8gJ+V5LCIHbUVm2dxQ=

cache:
  directories:
    - node_modules

notifications:
  email:
    on_success: never
